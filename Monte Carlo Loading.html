<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>State Estimation (NE) with Monte Carlo Loading</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <h2>5.5. State Estimation (NE) with Monte Carlo Loading</h2>

    <h3>Task Overview: </h3>
    <p>
        This task models state estimation in a three-bus power system using a hybrid approach:
        the Weighted Least Squares (WLS) method is applied to PQ node measurements and voltage magnitudes,
        while equality constraints (ECs) enforce zero-injection conditions at node 2.
        The system includes voltage measurements at all buses and active/reactive power injection at node 3.
    </p>

    <h3>Task Objective: </h3>
    <p>
        The goal is to estimate voltage magnitudes and phase angles in a 3-bus network,
        combining direct voltage measurements and power injection data with an algebraic constraint applied to bus 2.
        The estimation minimizes residuals while satisfying equality constraints.
    </p>

    <h3>Program Analysis: </h3>

    <p><strong>Model Definition</strong></p>
    <div class="code-block">
        Model [type=WLS domain=real name="Three nodes"]:	
    </div>

    <p>
        <code>type = "WLS"</code> – Weighted Least Squares estimation<br>
        <code>domain = "real"</code> – Real-number model
    </p>

    <p><strong>Vars Block</strong></p>

    <div class="code-block">
        Vars [out=true]:
            v_1=1
            phi_2=0
            v_2=1
            phi_3=0
            v_3=1	
    </div>

    <p><strong>Params Block</strong></p>

    <p>Contains:</p>
    <ul>
        <li>Weights: w<sub>inj</sub> = 0.1, w<sub>v</sub> = 0.1</li>
        <li>Admittance values (aY) and angles (θ)</li>
        <li>Injections at node 3: P₃ = –1, Q₃ = –0.3</li>
        <li>Measured voltages: v₁ = 1.000, v₂ = 0.984267, v₃ = 0.969386</li>
    </ul>

    <p><strong>WLSEs Block</strong></p>
    <div class="code-block">
        WLSEs:
            [w=w_inj]    P3 and Q3 injection equations at node 3
            [w=w_v]      Voltage magnitude measurements at nodes 1, 2, 3
    </div>
 
    <p><strong>ECs Block (Equality Constraints)</strong></p>

    <div class="code-block">
        ECs:
            v_2*aY22*cos(theta22) + aY21*v_1*cos(phi_2-theta21-phi_1) + aY23*v_3*cos(phi_2-theta23-phi_3) = 0
            -v_2*aY22*sin(theta22) + aY21*v_1*sin(phi_2-theta21-phi_1) + aY23*v_3*sin(phi_2-theta23-phi_3) = 0
    </div>


    <p>This constraint ensures zero net injection at node 2.</p>

    <h3>Numerical Results: </h3>

    <div class="figure">
        <img src="img/z4r4.png" alt="Estimated variables per iteration">
        <p class="caption">Figure 5.5.1: Estimated variables per iteration</p>
    </div>

    <ul>
        <li>Estimated voltages: v₁ = 1.000000, v₂ = 0.984267, v₃ = 0.969386</li>
        <li>Estimated angles: φ₂ = –0.028960, φ₃ = –0.058834</li>
        <li>Convergence achieved with residual error ε = 0</li>
    </ul>

    <h3>Graphical Results: </h3>

    <div class="figure">
        <img src="img/z4p4.png" alt="Convergence of residual error"width="500" height="400">
        <p class="caption">Figure 5.5.2: Convergence of residual error (log scale)</p>
    </div>

    <p>
        The error decreases exponentially across iterations,
        confirming stable convergence of the hybrid estimation model.
    </p>

    <h3>Conclusion: </h3>
    <p>
        The hybrid WLS model successfully integrates both measurement data and structural constraints,
        achieving fast and accurate convergence. Voltage measurements helped anchor the solution,
        while the zero-injection equality constraints at node 2 added robustness.
        The resulting state variables match expected values and reflect physical realism.
    </p>

</body>
</html>
